option(OPENMP "Activates OpenMP shared memory parallelization." OFF)

if (CMAKE_CXX_COMPILER MATCHES "archer")
    message(STATUS "archer detected, OpenMP enabled by default, so skipping OpenMP package search")
    add_definitions(-DAUTOPAS_OPENMP)
    set(OPENMP ON)
    return()
endif()

if (OPENMP)
    message(STATUS "OpenMP enabled.")
    find_package(OpenMP)

    if (OPENMP_FOUND)
        set (CMAKE_C_FLAGS "${CMAKE_C_FLAGS} ${OpenMP_C_FLAGS}")
        set (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${OpenMP_CXX_FLAGS}")
        set (CMAKE_EXE_LINKER_FLAGS "${CMAKE_EXE_LINKER_FLAGS} ${OpenMP_EXE_LINKER_FLAGS}")
        add_definitions(-DAUTOPAS_OPENMP)
    else()
        message(FATAL_ERROR "Could not find OpenMP!")
    endif()
else()
    message(STATUS "OpenMP disabled.")
endif()
